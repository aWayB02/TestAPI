# Архитектура приложения To-Do List

## Общая архитектура

Для реализации проекта используется архитектура MVC (Model-View-Controller) с элементами Clean Architecture для обеспечения тестируемости и разделения ответственности.

```
mermaid
graph TD
    A[Клиент] --> B[API Layer]
    B --> C[Service Layer]
    C --> D[Data Access Layer]
    D --> E[SQLite Database]
    C --> F[Business Logic]
```

## Компоненты архитектуры

### 1. API Layer (Presentation Layer)
- Обработка HTTP запросов
- Валидация входных данных
- Формирование ответов
- Маршрутизация запросов

### 2. Service Layer (Application Layer)
- Бизнес-логика приложения
- Координация между различными компонентами
- Обработка транзакций

### 3. Data Access Layer (Persistence Layer)
- Взаимодействие с базой данных
- ORM или прямые SQL запросы
- Маппинг данных

### 4. Models (Domain Layer)
- Определение структуры данных
- Бизнес-правила
- Валидация данных

## Паттерн MVC

Паттерн MVC (Model-View-Controller) - это архитектурный паттерн проектирования, который разделяет приложение на три основных компонента:

### Компоненты MVC

1. **Model (Модель)** - отвечает за данные и бизнес-логику
2. **View (Представление)** - отвечает за отображение данных пользователю
3. **Controller (Контроллер)** - обрабатывает пользовательский ввод и координирует работу между Model и View

### Реализация MVC в проекте

В проекте To-Do List используется адаптированная версия паттерна MVC:

#### 1. Model (Модель)
Файл: `models/todo.py`

Модель `Todo` представляет собой класс, который:
- Определяет структуру задачи (id, title, description, completed, created_at, updated_at)
- Содержит методы для работы с данными задачи (mark_completed, mark_uncompleted, update)
- Реализует преобразование в/из словаря (to_dict, from_dict)

#### 2. View (Представление)
В данном API-проекте представление реализовано в виде JSON-ответов, которые формируются в API слое.

#### 3. Controller (Контроллер)
Файл: `api/todo_api.py`

Контроллер реализован в виде FastAPI роутера, который:
- Обрабатывает HTTP запросы
- Выполняет валидацию входных данных
- Вызывает методы сервисного слоя
- Формирует HTTP ответы

## Технологии

- **Язык**: Python 3.x
- **Веб-фреймворк**: FastAPI (асинхронный, высокая производительность)
- **База данных**: SQLite (встроенный движок, не требует отдельной установки)
- **ORM**: SQLAlchemy (для удобной работы с БД)
- **Тестирование**: pytest

## Паттерны проектирования

### 1. Repository Pattern (Паттерн репозиторий)

Repository Pattern - это паттерн проектирования, который создает абстракцию между бизнес-логикой и слоем доступа к данным.

**Зачем он нужен:**
- Скрывает детали реализации работы с базой данных
- Позволяет легко менять способ хранения данных (с SQLite на PostgreSQL и т.д.)
- Упрощает тестирование бизнес-логики

**Как он реализован в проекте:**
В проекте репозиторий реализован в файле `repositories/todo_repository.py`. Он предоставляет простые методы для работы с задачами:
- `create()` - создание новой задачи
- `get_by_id()` - получение задачи по ID
- `get_all()` - получение всех задач
- `update()` - обновление задачи
- `delete()` - удаление задачи

Сервис (`services/todo_service.py`) использует репозиторий для работы с данными, не заботясь о деталях их хранения.

### 2. Service Pattern (Паттерн сервис)

Service Pattern - это паттерн проектирования, который инкапсулирует бизнес-логику приложения в отдельные классы-сервисы.

**Зачем он нужен:**
- Собирает всю бизнес-логику в одном месте
- Упрощает тестирование логики
- Повышает переиспользуемость кода

**Как он реализован в проекте:**
В проекте сервис реализован в файле `services/todo_service.py`. Он содержит методы для работы с задачами:
- `create_todo()` - создание задачи с валидацией
- `get_todo()` - получение задачи
- `get_all_todos()` - получение списка задач
- `update_todo()` - обновление задачи с валидацией
- `delete_todo()` - удаление задачи

API слой использует сервис для выполнения операций, не заботясь о деталях реализации.

### 3. Dependency Injection (Внедрение зависимостей)

Dependency Injection - это паттерн проектирования, при котором объект получает свои зависимости извне, а не создает их сам.

**Зачем он нужен:**
- Упрощает тестирование (можно подставить моки вместо реальных зависимостей)
- Снижает связность компонентов
- Повышает гибкость приложения

**Как он реализован в проекте:**
В проекте используется через систему зависимостей FastAPI. Когда API endpoint нуждается в сервисе, он получает его через параметры функции:

```python
def get_todo_service(db: Session = Depends(get_db)) -> TodoService:
    return TodoService(db)

@router.get("/{todo_id}")
async def get_todo(todo_id: int, service: TodoService = Depends(get_todo_service)):
    # service автоматически создается и передается в функцию
```

## Преимущества выбранной архитектуры

1. **Тестируемость** - каждый слой может быть протестирован отдельно
2. **Расширяемость** - легко добавлять новую функциональность
3. **Поддерживаемость** - четкое разделение ответственности
4. **Гибкость** - возможность замены компонентов без изменения всей системы
5. **Масштабируемость** - архитектура позволяет легко масштабировать приложение